<?xml version="1.0" encoding="UTF-8"?>
<bpel:process xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
 xsi:schemaLocation="http://docs.oasis-open.org/wsbpel/2.0/process/executable ../../../../ws-bpel_executable.xsd"
 xmlns:ns1="http://www.example.org/test/"
 xmlns:xsd="http://www.w3.org/2001/XMLSchema"
 xmlns:bpel="http://docs.oasis-open.org/wsbpel/2.0/process/executable"
 expressionLanguage="urn:active-endpoints:expression-language:xquery1.0"
 name="testMessageReceiver"
 suppressJoinFailure="yes"
 targetNamespace="urn:bpelg:test">
   <bpel:extensions>
      <bpel:extension namespace="http://www.w3.org/2001/XMLSchema-instance" mustUnderstand="no"/>
   </bpel:extensions>
   <bpel:import importType="http://schemas.xmlsoap.org/wsdl/" location="wsdl/example.wsdl"
      namespace="http://www.example.org/test/"/>
   <bpel:partnerLinks>
      <bpel:partnerLink myRole="proces" name="testPartnerLinkType"
         partnerLinkType="ns1:testPartnerLinkType"/>
      <bpel:partnerLink myRole="proces" name="testPartnerLinkType3"
         partnerLinkType="ns1:testPartnerLinkType3"/>
   </bpel:partnerLinks>
   <bpel:variables>
      <bpel:variable element="ns1:CreateProcessRequest" name="CreateProcessRequest"/>
      <bpel:variable element="ns1:CreateProcessResponse" name="CreateProcessResponse"/>
      <bpel:variable element="ns1:request" name="request"/>
      <bpel:variable element="ns1:response" name="response"/>
   </bpel:variables>
   <bpel:correlationSets>
      <bpel:correlationSet name="CS1" properties="ns1:id"/>
   </bpel:correlationSets>
   <bpel:sequence>
      <bpel:receive createInstance="yes" operation="createProcess" partnerLink="testPartnerLinkType"
         variable="CreateProcessRequest"/>
      <bpel:assign>
         <bpel:copy>
            <bpel:from>
               <bpel:literal>
                  <ns1:CreateProcessResponse>
                     <ns1:value>call-me-back</ns1:value>
                  </ns1:CreateProcessResponse>
               </bpel:literal>
            </bpel:from>
            <bpel:to variable="CreateProcessResponse"/>
         </bpel:copy>
      </bpel:assign>
      <bpel:reply operation="createProcess" partnerLink="testPartnerLinkType"
         variable="CreateProcessResponse">
         <bpel:correlations>
            <bpel:correlation set="CS1" initiate="yes"/>
         </bpel:correlations>
      </bpel:reply>

   
      <bpel:receive operation="twoWay" partnerLink="testPartnerLinkType3"
         variable="request">
         <bpel:correlations>
            <bpel:correlation set="CS1"></bpel:correlation>
         </bpel:correlations>
      </bpel:receive>
      <bpel:assign>
         <bpel:copy>
            <bpel:from>
               <bpel:literal>
                  <ns1:response>
                     <ns1:value>SUCCESS</ns1:value>
                  </ns1:response>
               </bpel:literal>
            </bpel:from>
            <bpel:to variable="response"/>
         </bpel:copy>
      </bpel:assign>
      <bpel:reply operation="twoWay" partnerLink="testPartnerLinkType3"
         variable="response"/>
   </bpel:sequence>
</bpel:process>
